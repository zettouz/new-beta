local Tunnel = module("vrp","lib/Tunnel")
local Proxy = module("vrp","lib/Proxy")
vRP = Proxy.getInterface("vRP")
emP = Tunnel.getInterface("vrp_races")
-----------------------------------------------------------------------------------------------------------------------------------------
-- VARIAVEIS
-----------------------------------------------------------------------------------------------------------------------------------------
local racePos = 0
local timeRace = 0
local cooldown = 0
local racePoint = 1
local inRace = false
local blipRace = false
local porcentage = 10
local raceX = 1648.66
local raceY = 3235.61
local raceZ = 40.48
-----------------------------------------------------------------------------------------------------------------------------------------
-- VARIAVEIS
-----------------------------------------------------------------------------------------------------------------------------------------
local races = {
	[1] = {
		['time'] = 290,
		[1] = { 1853.68,3224.35,44.23 },
		[2] = { 2337.85,2977.9,47.54 },
		[3] = { 2412.15,2904.74,48.68 },
		[4] = { 2250.46,2784.29,43.16 },
		[5] = { 1988.41,2583.92,53.86 },
		[6] = { 1891.01,2291.47,53.92 },
		[7] = { 2023.98,1535.36,74.79 },
		[8] = { 2273.77,1093.41,64.9 },
		[9] = { 2415.12,708.12,129.13 },
		[10] = { 2311.76,211.71,202.17 },
		[11] = { 2004.69,-47.79,205.27 },
		[12] = { 1870.02,-87.6,188.86 },
		[13] = { 1605.33,-75.49,163.49 },
		[14] = { 1291.4,-280.03,85.61 },
		[15] = { 1182.89,-462.77,65.68 },
		[16] = { 953.65,-573.31,57.92 },
		[17] = { 1121.18,-759.54,57.12 },
		[18] = { 1029.44,-841.03,47.89 },
		[19] = { 446.02,-851.25,32.04 },
		[20] = { 462.38,-825.06,26.51 },
		[21] = { 501.57,-1221.84,28.66 },
		[22] = { 265.88,-1415.16,28.84 },
		[23] = { 205.21,-1572.91,28.65 },
		[24] = { -35.25,-1464.2,30.75 },
		[25] = { -255.37,-1397.64,30.63 },
		[26] = { -257.23,-1014.15,28.42 },
		[27] = { -361.77,-1084.32,27.22 },
		[28] = { -162.22,-1142.21,22.98 },
		[29] = { -44.81,-998.17,28.55 },
		[30] = { 529.36,-1034.75,36.8 },
		[31] = { 711.42,-1077.99,21.67 }
	},
	[2] = {
		['time'] = 360,
		[1] = { 1850.05,3228.81,44.18 },
		[2] = { 2185.36,2903.33,46.0 },
		[3] = { 1962.95,2584.41,51.95 },
		[4] = { 1528.04,832.61,76.83 },
		[5] = { 1379.31,678.49,79.03 },
		[6] = { 1080.91,322.6,89.45 },
		[7] = { 740.22,78.66,80.95 },
		[8] = { 266.18,-367.84,44.27 },
		[9] = { 51.84,-693.37,43.64 },
		[10] = { -50.99,-747.31,43.64 },
		[11] = { 197.49,-829.69,30.38 },
		[12] = { 275.36,-891.55,28.42 },
		[13] = { 429.74,-954.59,28.63 },
		[14] = { 500.89,-1084.56,28.35 },
		[15] = { 252.3,-1173.16,37.55 },
		[16] = { 21.13,-1046.1,35.32 },
		[17] = { -270.45,-861.19,30.98 },
		[18] = { -315.79,-762.27,52.63 },
		[19] = { -82.43,-615.27,35.69 },
		[20] = { 166.34,-547.33,34.97 },
		[21] = { 445.99,-364.19,46.52 },
		[22] = { 560.88,-579.36,43.82 },
		[23] = { 658.59,-1629.86,9.09 },
		[24] = { 486.61,-2056.64,24.53 },
		[25] = { 337.64,-2445.54,6.91 },
		[26] = { 627.83,-2661.1,5.48 },
		[27] = { 741.63,-2907.15,5.28 },
		[28] = { 911.18,-3061.67,5.28 },
		[29] = { 934.37,-2945.83,5.28 },
		[30] = { 796.72,-2911.26,5.28 },
		[31] = { 629.02,-2888.74,5.42 }
	},
	[3] = {
		['time'] = 400,
		[1] = { 1840.86,3235.31,43.85 },
		[2] = { 2224.67,3011.28,44.61 },
		[3] = { 2250.16,3198.22,48.0 },
		[4] = { 2655.91,3394.41,55.25 },
		[5] = { 2832.52,3462.41,54.57 },
		[6] = { 2825.57,4355.41,49.21 },
		[7] = { 2815.85,4991.55,62.73 },
		[8] = { 2296.74,5989.43,60.55 },
		[9] = { 1916.17,6239.07,54.37 },
		[10] = { 1678.52,6364.31,31.17 },
		[11] = { 214.19,6567.85,31.31 },
		[12] = { -55.74,6478.9,30.8 },
		[13] = { -217.71,6417.42,30.92 },
		[14] = { -408.78,6192.78,31.03 },
		[15] = { -574.8,6077.06,13.81 },
		[16] = { -790.36,5538.95,33.08 },
		[17] = { -1460.12,5048.27,61.19 },
		[18] = { -2289.95,4204.85,40.38 },
		[19] = { -2463.33,3767.07,18.06 },
		[20] = { -2996.26,3442.91,8.89 },
		[21] = { -2691.52,3086.97,26.28 },
		[22] = { -2642.71,2783.95,16.07 },
		[23] = { -3053.75,1406.81,21.32 },
		[24] = { -3228.27,1027.58,11.21 },
		[25] = { -2242.28,-341.4,12.84 },
		[26] = { -1985.49,-178.54,29.6 },
		[27] = { -1878.59,-389.23,47.4 },
		[28] = { -1657.63,-226.87,54.38 }
	},
	[4] = {
		['time'] = 240,
		[1] = { 1832.71,3236.98,43.51 },
		[2] = { 2275.12,3003.4,45.27 },
		[3] = { 1895.11,2374.49,54.27 },
		[4] = { 1527.25,830.36,76.83 },
		[5] = { 1065.73,400.34,90.59 },
		[6] = { 758.73,-50.74,58.46 },
		[7] = { 566.22,-285.32,43.21 },
		[8] = { 317.08,-179.26,56.99 },
		[9] = { 206.88,-160.15,56.18 },
		[10] = { 221.7,-34.79,69.1 },
		[11] = { 477.86,-83.19,69.58 },
		[12] = { 737.11,74.93,81.36 },
		[13] = { 705.87,199.64,89.14 },
		[14] = { 581.96,167.21,99.0 },
		[15] = { 291.67,-281.51,53.36 },
		[16] = { 234.24,-350.63,43.75 },
		[17] = { 139.83,-362.47,42.63 },
		[18] = { 50.85,-695.96,43.64 },
		[19] = { -64.98,-767.47,43.63 },
		[20] = { 33.01,-799.33,43.59 },
		[21] = { 142.09,-1015.68,28.78 },
		[22] = { 232.52,-915.59,25.85 },
		[23] = { 270.22,-995.62,28.69 },
		[24] = { 329.42,-999.92,28.61 }
	},
	[5] = {
		['time'] = 240,
		[1] = { 1847.83,3234.11,44.02 },
		[2] = { 2186.92,2881.08,46.21 },
		[3] = { 1852.37,2491.23,45.33 },
		[4] = { 1560.48,2433.01,45.33 },
		[5] = { 1703.92,2774.72,45.33 },
		[6] = { 941.27,2695.22,39.88 },
		[7] = { 643.37,2587.1,54.43 },
		[8] = { 686.73,2348.1,49.77 },
		[9] = { 1289.83,1322.33,106.01 },
		[10] = { 1360.8,1172.36,112.33 },
		[11] = { 1267.56,801.76,104.04 },
		[12] = { 885.94,282.25,86.21 },
		[13] = { 657.75,217.1,95.61 },
		[14] = { 331.54,-328.04,49.28 },
		[15] = { 128.18,-707.25,32.5 },
		[16] = { -10.81,-889.2,29.34 },
		[17] = { 422.07,-1068.31,28.59 },
		[18] = { 477.91,-1110.95,28.58 },
		[19] = { 384.99,-1155.0,28.67 }
	},
	[6] = {
		['time'] = 280,
		[1] = { 1788.1,3307.69,40.97 },
		[2] = { 1725.87,3459.2,38.38 },
		[3] = { 1014.3,3536.23,33.39 },
		[4] = { 864.81,3633.93,32.31 },
		[5] = { 546.2,3574.46,32.46 },
		[6] = { 336.77,3448.15,35.41 },
		[7] = { 221.29,3050.22,41.68 },
		[8] = { -1084.92,2692.0,19.57 },
		[9] = { -1355.18,2241.17,46.48 },
		[10] = { -1431.39,1942.78,72.23 },
		[11] = { -1709.29,863.48,145.84 },
		[12] = { -2019.18,824.57,162.1 },
		[13] = { -2630.64,1192.49,155.12 },
		[14] = { -2746.85,1391.75,86.48 },
		[15] = { -3035.37,1226.19,24.95 },
		[16] = { -3024.52,271.22,15.0 },
		[17] = { -2015.05,-478.6,10.8 },
		[18] = { -1814.2,-786.86,7.44 },
		[19] = { -1623.86,-1079.27,3.75 },
		[20] = { -1336.59,-1644.01,1.94 },
		[21] = { -1213.68,-1800.39,3.29 }
	},
	[7] = {
		['time'] = 300,
		[1] = { 1791.02,3311.75,41.04 },
		[2] = { 1725.06,3460.61,38.39 },
		[3] = { 1023.04,3536.12,33.42 },
		[4] = { 219.58,3073.03,41.68 },
		[5] = { -517.47,2768.39,39.58 },
		[6] = { -769.75,2207.47,91.63 },
		[7] = { -845.65,1785.24,172.39 },
		[8] = { -719.91,1039.7,243.27 },
		[9] = { -1001.18,798.98,171.18 },
		[10] = { -679.11,650.72,148.58 },
		[11] = { -534.4,313.88,82.43 },
		[12] = { -166.14,248.6,92.88 },
		[13] = { -117.39,128.82,76.17 },
		[14] = { 49.49,73.01,74.91 },
		[15] = { 216.57,52.26,83.33 },
		[16] = { 296.82,-39.81,71.82 },
		[17] = { 515.93,-236.04,48.57 },
		[18] = { 770.92,-626.12,28.24 },
		[19] = { 911.03,-820.4,42.89 },
		[20] = { 976.33,-944.22,41.86 },
		[21] = { 496.02,-1037.82,35.17 },
		[22] = { 161.45,-1019.24,28.76 },
		[23] = { 24.39,-1038.44,28.7 },
		[24] = { -89.94,-1081.07,26.13 },
		[25] = { -480.11,-1092.53,25.46 },
		[26] = { -501.52,-880.67,28.36 },
		[27] = { -539.52,-713.46,32.61 },
		[28] = { -494.62,-581.19,24.68 },
		[29] = { -790.17,-578.64,29.51 }
	},
	[8] = {
		['time'] = 330,
		[1] = { 1840.98,3238.62,43.76 },
		[2] = { 2421.29,2893.78,49.31 },
		[3] = { 2864.96,3539.69,53.88 },
		[4] = { 2788.85,4359.23,49.67 },
		[5] = { 2653.40,5066.89,44.83 },
		[6] = { 2389.77,5185.05,51.59 },
		[7] = { 2276.28,5181.67,60.05 },
		[8] = { 2095.09,5037.37,40.89 },
		[9] = { 2189.16,4787.11,42.90 },
		[10] = { 2486.37,4149.53,37.22 },
		[11] = { 2102.55,3742.99,33.01 },
		[12] = { 2024.76,3786.67,32.30 },
		[13] = { 1961.78,3789.15,31.70 },
		[14] = { 1907.37,3805.73,31.75 },
		[15] = { 660.98,3518.82,33.56 },
		[16] = { 278.88,2657.00,44.04 },
		[17] = { 676.89,2294.95,51.11 },
		[18] = { -93.80,1991.56,182.58 },
		[19] = { 231.79,1380.35,239.68 },
		[20] = { -712.31,1176.02,264.46 },
		[21] = { -502.89,611.10,127.9 },
		[22] = { 46.39,349.16,111.83 },
		[23] = { 91.36,316.42,111.35 },
		[24] = { 204.14,290.80,105.58 },
		[25] = { 245.40,312.19,105.58 },
		[26] = { 378.59,286.50,102.51 }
	},
	[9] = {
		['time'] = 260,
		[1] = { 1821.83,3249.97,43.03 },
		[2] = { 1947.64,3140.15,46.23 },
		[3] = { 1927.14,3005.17,45.06 },
		[4] = { 314.52,2644.39,43.913 },
		[5] = { 804.76,2252.85,47.96 },
		[6] = { 1137.99,566.08,97.30 },
		[7] = { 640.91,44.43,86.80 },
		[8] = { 668.24,189.06,92.42 },
		[9] = { 286.91,331.55,104.99 },
		[10] = { 93.48,-106.98,57.85 },
		[11] = { -25.21,-120.89,56.44 },
		[12] = { -102.79,-193.64,46.19 },
		[13] = { -387.13,-208.59,35.92 },
		[14] = { -540.51,-70.48,40.78 },
		[15] = { -1114.98,-281.08,37.14 },
		[16] = { -1336.08,-357.95,36.10 },
		[17] = { -1758.35,66.66,67.59 },
		[18] = { -2160.28,496.26,145.40 },
		[19] = { -2333.18,264.65,168.97 }
	},
	[10] = {
		['time'] = 240,
		[1] = { 1835.26,3295.10,42.72 },
		[2] = { 1960.24,3298.90,44.87 },
		[3] = { 2202.61,3244.15,47.29 },
		[4] = { 2111.02,3580.49,40.96 },
		[5] = { 2305.81,3750.28,37.29 },
		[6] = { 2327.07,3849.31,34.34 },
		[7] = { 2468.40,4035.74,36.84 },
		[8] = { 2449.86,4251.58,36.33 },
		[9] = { 2547.32,4317.54,39.29 },
		[10] = { 2549.68,4395.54,38.02 },
		[11] = { 2590.18,4508.28,35.69 },
		[12] = { 2584.26,4573.46,33.28 },
		[13] = { 2588.71,4644.86,32.96 },
		[14] = { 2590.09,4702.05,32.57 },
		[15] = { 2613.03,4764.34,33.04 },
		[16] = { 2696.42,4632.06,40.71 },
		[17] = { 2710.27,4499.17,40.70 },
		[18] = { 2512.60,4317.52,38.62 },
		[19] = { 2486.28,4146.59,37.26 },
		[20] = { 2769.47,4399.21,48.34 },
		[21] = { 2936.98,3925.44,52.03 },
		[22] = { 2864.54,3580.96,52.50 },
		[23] = { 2687.60,3268.45,54.61 },
		[24] = { 2632.08,3117.43,48.37 },
		[25] = { 2473.96,2900.63,45.93 },
		[26] = { 2592.50,2559.31,32.22 },
		[27] = { 2436.19,2506.02,41.83 },
		[28] = { 2319.77,2603.55,46.04 },
		[29] = { 2299.40,2531.78,46.04 },
		[30] = { 2571.14,2506.43,29.48 },
		[31] = { 2538.26,1690.95,26.98 },
		[32] = { 2632.14,1639.27,25.93 },
		[33] = { 2774.04,1641.06,23.93 },
		[34] = { 2757.30,1368.10,23.89 }
	},
	[11] = {
		['time'] = 210,
		[1] = { 1850.99,3229.52,44.18 },
		[2] = { 2292.07,2998.17,45.86 },
		[3] = { 1994.91,2589.97,53.86 },
		[4] = { 1664.12,1306.84,86.02 },
		[5] = { 1172.29,503.70,85.05 },
		[6] = { 965.09,519.07,108.49 },
		[7] = { 591.17,290.25,103.65 },
		[8] = { 467.53,279.92,102.44 },
		[9] = { 376.61,187.98,102.47 },
		[10] = { -476.27,255.33,82.43 },
		[11] = { -557.07,-15.65,43.39 },
		[12] = { -250.09,-410.15,29.59 },
		[13] = { -242.61,-605.72,33.49 },
		[14] = { -161.40,-709.97,33.97 },
		[15] = { -169.12,-837.18,29.98 },
		[16] = { -84.64,-935.56,28.68 },
		[17] = { -108.92,-1310.58,28.71 },
		[18] = { -166.84,-1502.28,32.53 },
		[19] = { -183.99,-1669.01,32.87 },
		[20] = { 24.10,-1872.74,22.49 },
		[21] = { 177.22,-1896.66,22.89 },
		[22] = { 461.94,-1691.82,28.65 }
	},
	[12] = {
		['time'] = 230,
		[1] = { 1850.03,3230.87,44.15 },
		[2] = { 2318.89,2987.33,46.92 },
		[3] = { 2101.96,2671.53,50.22 },
		[4] = { 1973.07,2494.93,53.96 },
		[5] = { 1850.32,2230.31,61.77 },
		[6] = { 1727.23,1574.14,83.82 },
		[7] = { 1807.57,1617.79,82.82 },
		[8] = { 2091.18,1396.11,74.91 },
		[9] = { 2226.46,1230.22,76.14 },
		[10] = { 2496.45,773.71,96.80 },
		[11] = { 2555.21,326.71,107.82 },
		[12] = { 2464.51,-92.50,90.60 },
		[13] = { 2380.63,-439.95,72.09 },
		[14] = { 2150.46,-826.77,75.70 },
		[15] = { 1430.51,-1535.78,59.74 },
		[16] = { 1270.87,-1473.89,35.72 },
		[17] = { 848.41,-1433.25,27.68 },
		[18] = { 371.04,-1477.83,28.70 },
		[19] = { 398.19,-1694.77,28.67 },
		[20] = { 384.94,-1658.13,26.68 }
	},
	[13] = {
		['time'] = 280,
		[1] = { 1793.21,3318.58,41.06 },
		[2] = { 1569.90,3722.96,33.89 },
		[3] = { 1935.46,3931.49,31.83 },
		[4] = { 2486.91,4081.53,37.31 },
		[5] = { 2485.20,4471.76,34.51 },
		[6] = { 2574.68,4630.48,32.93 },
		[7] = { 2378.92,4892.00,41.02 },
		[8] = { 2202.88,4943.31,40.45 },
		[9] = { 2106.19,4974.31,40.42 },
		[10] = { 1986.71,4928.14,42.03 },
		[11] = { 1840.90,5009.18,53.95 },
		[12] = { 1695.87,4671.16,42.66 },
		[13] = { 2026.59,4648.22,40.57 },
		[14] = { 2406.11,4640.12,36.25 },
		[15] = { 2734.81,4889.63,33.06 },
		[16] = { 2682.59,5125.87,44.23 },
		[17] = { 2008.51,6202.50,46.68 },
		[18] = { 559.68,6549.07,27.20 },
		[19] = { -563.32,5702.20,36.79 },
		[20] = { -654.56,5360.43,57.71 },
		[21] = { -659.81,5246.05,75.63 },
		[22] = { -573.96,5372.18,69.60 }
	},
	[14] = {
		['time'] = 260,
		[1] = { 1917.75,3168.95,45.83 },
		[2] = { 2034.40,3000.70,44.61 },
		[3] = { 1335.18,2683.48,37.10 },
		[4] = { 1409.37,2395.78,62.51 },
		[5] = { 1217.52,2372.58,63.94 },
		[6] = { 1122.90,2481.19,51.20 },
		[7] = { 897.48,2543.61,61.90 },
		[8] = { 793.69,2313.79,47.55 },
		[9] = { 426.01,2126.80,90.42 },
		[10] = { 108.94,2100.00,139.04 },
		[11] = { -10.69,2066.98,159.95 },
		[12] = { -11.79,1819.87,207.32 },
		[13] = { 99.66,1687.39,226.95 },
		[14] = { 581.33,1799.31,206.20 },
		[15] = { 1136.58,1417.01,161.44 },
		[16] = { 1120.49,850.66,151.63 },
		[17] = { 940.70,800.27,191.74 },
		[18] = { 645.00,781.97,204.40 },
		[19] = { 304.28,845.709,192.47 },
		[20] = { 124.64,673.60,207.73 },
		[21] = { -71.45,596.21,207.01 },
		[22] = { -385.08,775.92,219.66 },
		[23] = { -668.40,996.31,238.09 },
		[24] = { -706.61,1108.56,257.26 },
		[25] = { -512.61,1326.78,301.27 },
		[26] = { -397.58,1228.33,325.01 }
	},
	[15] = {
		['time'] = 370,
		[1] = { 1822.3,3241.11,43.22 },
		[2] = { 2411.09,2906.42,48.92 },
		[3] = { 2370.25,1191.76,60.09 },
		[4] = { 2492.7,791.51,95.77 },
		[5] = { 2594.67,271.01,104.74 },
		[6] = { 2392.45,-287.55,84.52 },
		[7] = { 1760.82,-855.27,71.69 },
		[8] = { 1385.93,-1115.1,52.36 },
		[9] = { 1088.07,-1362.17,31.79 },
		[10] = { 1120.59,-1780.3,28.86 },
		[11] = { 1206.73,-1996.06,42.81 },
		[12] = { 991.06,-2081.3,30.74 },
		[13] = { 903.19,-2410.8,28.86 },
		[14] = { 728.77,-2591.07,18.26 },
		[15] = { 720.81,-3045.05,11.35 },
		[16] = { 1137.24,-3325.77,5.5 },
		[17] = { 1257.52,-3260.65,5.39 },
		[18] = { 1208.74,-3082.16,5.48 },
		[19] = { 1057.88,-2935.92,5.48 },
		[20] = { 632.52,-2891.58,5.63 },
		[21] = { 612.15,-2769.7,5.64 },
		[22] = { 467.7,-2499.58,5.92 },
		[23] = { 561.49,-2473.78,15.51 },
		[24] = { 746.36,-2449.76,19.55 },
		[25] = { 843.6,-1682.05,28.94 },
		[26] = { 775.51,-1176.24,27.91 },
		[27] = { 616.21,-1153.5,9.65 },
		[28] = { 797.09,-463.73,29.43 },
		[29] = { 1212.34,-592.3,35.94 },
		[30] = { 1519.83,-966.05,66.22 },
		[31] = { 1660.55,-923.12,64.95 },
		[32] = { 2159.34,-551.46,94.04 },
		[33] = { 2345.1,-440.23,72.81 },
		[34] = { 2599.94,-573.51,68.98 },
		[35] = { 2492.44,-287.81,92.57 }
	},
	[16] = {
		['time'] = 345,
		[1] = { 1812.05,3244.45,42.74 },
		[2] = { 2136.82,3263.42,45.67 },
		[3] = { 2298.52,3048.54,45.96 },
		[4] = { 2338.03,2913.07,46.71 },
		[5] = { 1821.71,2339.7,55.78 },
		[6] = { 1568.56,942.18,77.61 },
		[7] = { 1657.62,1041.54,114.41 },
		[8] = { 1951.39,1324.22,162.35 },
		[9] = { 1921.34,852.92,203.54 },
		[10] = { 1786.51,432.53,172.35 },
		[11] = { 1659.38,-2.43,173.35 },
		[12] = { 1496.71,-106.11,146.89 },
		[13] = { 1247.35,-280.9,75.9 },
		[14] = { 1046.72,-211.44,69.75 },
		[15] = { 865.78,-334.17,60.78 },
		[16] = { 781.43,-300.37,59.47 },
		[17] = { 723.8,-306.34,54.99 },
		[18] = { 696.19,-374.07,40.89 },
		[19] = { 379.36,-393.82,45.84 },
		[20] = { 222.42,-734.72,33.78 },
		[21] = { 228.96,-744.91,30.4 },
		[22] = { 225.73,-815.29,30.03 },
		[23] = { 231.29,-916.05,25.78 },
		[24] = { 224.03,-1011.03,28.88 },
		[25] = { 213.45,-1256.11,28.92 },
		[26] = { 130.29,-1272.91,28.72 },
		[27] = { -52.03,-1133.9,25.63 },
		[28] = { -101.31,-1029.46,26.85 },
		[29] = { -222.88,-1166.99,22.57 },
		[30] = { -141.21,-1174.69,24.79 },
		[31] = { -25.96,-1082.44,26.2 },
		[32] = { 21.4,-1140.25,28.77 },
		[33] = { 61.79,-1420.18,28.89 },
		[34] = { -19.2,-1499.79,29.72 },
		[35] = { -91.9,-1402.05,28.9 },
		[36] = { 11.08,-961.89,28.99 },
		[37] = { 39.97,-868.42,30.06 }
	}
}
-----------------------------------------------------------------------------------------------------------------------------------------
-- STARTRACES
-----------------------------------------------------------------------------------------------------------------------------------------
Citizen.CreateThread(function()
	while true do
		if not inRace then
			local ped = GetPlayerPed(-1)
			if IsPedInAnyVehicle(ped) then
				local x,y,z = table.unpack(GetEntityCoords(ped))
				local distance = Vdist(x,y,z,raceX,raceY,raceZ)
				if distance <= 200.0 then
					local vehicle = GetVehiclePedIsUsing(ped)
					if IsEntityAVehicle(vehicle) and GetPedInVehicleSeat(vehicle,-1) == ped then
						DrawMarker(23,raceX,raceY,raceZ-0.8,0,0,0,0,0,0,25.0,25.0,1.0,255,0,0,50,0,0,0,0)
						if distance <= 12.0 then
							drawTxt("PRESSIONE  ~b~E~w~  PARA INICIAR A CORRIDA",4,0.5,0.93,0.50,255,255,255,180)
							if IsControlJustPressed(1,38) then
								if emP.checkTicket() then
									if cooldown <= 0 then
										racePos = 1
										inRace = true
										cooldown = 180
										racePoint = emP.getRacepoint()
										timeRace = parseInt(races[racePoint].time)
										createBlipsRace()
										emP.startRace()
									else
										TriggerEvent("Notify","importante","Aguarde <b>"..parseInt(cooldown).." segundos</b> para iniciar uma nova corrida.",8000)
									end
								else
									TriggerEvent("Notify","importante","Você não possui o ticket necessário para participar das corridas.",8000)
								end
							end
						end
					end
				end
			end
		end
		Citizen.Wait(1)
	end
end)
-----------------------------------------------------------------------------------------------------------------------------------------
-- CHECKPOINTS
-----------------------------------------------------------------------------------------------------------------------------------------
Citizen.CreateThread(function()
	while true do
		if inRace then
			local ped = GetPlayerPed(-1)
			if IsPedInAnyVehicle(ped) then
				local x,y,z = table.unpack(GetEntityCoords(ped))
				local distance = Vdist(x,y,z,races[racePoint][racePos][1],races[racePoint][racePos][2],races[racePoint][racePos][3])
				if distance <= 200.0 then
					DrawMarker(1,races[racePoint][racePos][1],races[racePoint][racePos][2],races[racePoint][racePos][3]-3,0,0,0,0,0,0,12.0,12.0,8.0,255,255,255,25,0,0,0,0)
					DrawMarker(21,races[racePoint][racePos][1],races[racePoint][racePos][2],races[racePoint][racePos][3]+1,0,0,0,0,180.0,130.0,3.0,3.0,2.0,255,0,0,50,1,0,0,1)
					if distance <= 10.0 then
						if DoesBlipExist(blipRace) then
							RemoveBlip(blipRace)
						end

						if racePos == #races[racePoint] then
							inRace = false
							emP.removeRace(racePoint,true)
							PlaySoundFrontend(-1,"RACE_PLACED","HUD_AWARDS",false)
						else
							racePos = racePos + 1
							createBlipsRace()
						end
					end
				end
			end
		end
		Citizen.Wait(1)
	end
end)
-----------------------------------------------------------------------------------------------------------------------------------------
-- TEXTDRAWN
-----------------------------------------------------------------------------------------------------------------------------------------
Citizen.CreateThread(function()
	while true do
		if inRace and timeRace > 0 and IsPedInAnyVehicle(GetPlayerPed(-1)) then
			drawTxt("RESTAM ~b~"..timeRace.." SEGUNDOS ~w~PARA CHEGAR AO DESTINO FINAL DA CORRIDA",4,0.5,0.905,0.45,255,255,255,100)
			drawTxt("VENÇA A CORRIDA E SUPERE SEUS PROPRIOS RECORDES ANTES DO TEMPO ACABAR",4,0.5,0.93,0.38,255,255,255,50)
		end
		Citizen.Wait(1)
	end
end)
-----------------------------------------------------------------------------------------------------------------------------------------
-- COOLDOWN
-----------------------------------------------------------------------------------------------------------------------------------------
Citizen.CreateThread(function()
	while true do
		if cooldown > 0 then
			cooldown = cooldown - 1
		end
		Citizen.Wait(1000)
	end
end)
-----------------------------------------------------------------------------------------------------------------------------------------
-- TIMERACE
-----------------------------------------------------------------------------------------------------------------------------------------
Citizen.CreateThread(function()
	while true do
		if inRace and timeRace > 0 then
			timeRace = timeRace - 1
			if timeRace <= 0 or not IsPedInAnyVehicle(GetPlayerPed(-1)) then
				inRace = false

				if DoesBlipExist(blipRace) then
					RemoveBlip(blipRace)
				end

				SetTimeout(3000,function()
					timeRace = 0
					emP.removeRace(racePoint,false)
					AddExplosion(GetEntityCoords(GetPlayersLastVehicle()),1,1.0,true,true,true)
				end)
			end
		end

		Citizen.Wait(1000)
	end
end)
-----------------------------------------------------------------------------------------------------------------------------------------
-- DRAWTXT
-----------------------------------------------------------------------------------------------------------------------------------------
function drawTxt(text,font,x,y,scale,r,g,b,a)
	SetTextFont(font)
	SetTextScale(scale,scale)
	SetTextColour(r,g,b,a)
	SetTextOutline()
	SetTextCentre(1)
	SetTextEntry("STRING")
	AddTextComponentString(text)
	DrawText(x,y)
end
-----------------------------------------------------------------------------------------------------------------------------------------
-- CREATEBLIPRACE
-----------------------------------------------------------------------------------------------------------------------------------------
function createBlipsRace()
	blipRace = AddBlipForCoord(races[racePoint][racePos][1],races[racePoint][racePos][2],races[racePoint][racePos][3])
	SetBlipSprite(blipRace,1)
	SetBlipColour(blipRace,1)
	SetBlipScale(blipRace,0.4)
	SetBlipAsShortRange(blipRace,false)
	SetBlipRoute(blipRace,true)
	BeginTextCommandSetBlipName("STRING")
	AddTextComponentString("Checkpoint")
	EndTextCommandSetBlipName(blipRace)
end
-----------------------------------------------------------------------------------------------------------------------------------------
-- DEFUSE
-----------------------------------------------------------------------------------------------------------------------------------------
RegisterNetEvent("vrp_races:defuse")
AddEventHandler("vrp_races:defuse",function()
	inRace = false

	if DoesBlipExist(blipRace) then
		RemoveBlip(blipRace)
	end

	emP.removeRace(racePoint,false)
end)